<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DynaMix: Appendix</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DynaMix
   &#160;<span id="projectnumber">1.3.7</span>
   </div>
   <div id="projectbrief">A new take on polymorphism in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('appendix.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Appendix </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#aecs">Appendix A. Entity-Component-System </a><ul><li class="level2"><a href="#what_is_ecs">What is an entity-component-system </a></li>
<li class="level2"><a href="#why_is_ecs_good">Why are entity-component-systems good? </a></li>
<li class="level2"><a href="#nonpoly_ecs">Non-polymorphic entity-component-systems </a></li>
<li class="level2"><a href="#who_uses_ecs">Who uses entity-component-systems? </a></li>
<li class="level2"><a href="#more_ecs">Further reading </a></li>
</ul>
</li>
<li class="level1"><a href="#app_vs_watch">Appendix B. Visual Studio watch visualizers </a><ul><li class="level2"><a href="#watch_mixin">Watching a mixin </a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="aecs"></a>
Appendix A. Entity-Component-System </h1>
<h2><a class="anchor" id="what_is_ecs"></a>
What is an entity-component-system </h2>
<p>An entity-component-system (ECS) allows users to create entities which consist of components. A simplified way of thinking about that is a container of instances of unique types. Another way of thinking about said entities is like they are objects produced from multiple inheritance only they are constructed in runtime, as opposed to compile-time.</p>
<p>Here's a piece of code that might be used in a simple hypothetical ECS: </p><pre class="fragment">entity e;
e.add_component(new xml_serializer);
e.add_component(new book_data);
</pre><p> now the entity contains data and a way to serialize this data ... here we can test if an entity has the components we need if(e.has_component&lt;xml_serializer&gt;()) { e.get_component&lt;xml_serializer&gt;()-&gt;serialize(); }</p>
<p>See how we can think of <code>e</code> as a container of various objects, or as a class derived from both <code>serializer</code> and <code>data</code>. However it is not exactly a container as it cannot have two instances of the same class, and it is not exactly a class with multiple inheritance as its contents cannot be statically analyzed.</p>
<h2><a class="anchor" id="why_is_ecs_good"></a>
Why are entity-component-systems good? </h2>
<p>They allow the users to achieve true decoupling of their subsystems. For example if we extend the above example to have a registered component of type <code>serializer</code>, which is a pure virtual class with a method <code>virtual void serialize() = 0</code>, the code example from above would still work, but we would be able to change the last part to something a bit more useful: </p><pre class="fragment">if(e.has_component&lt;serializer&gt;())
{
    e.get_component&lt;serializer&gt;()-&gt;serialize();
}
</pre><p>Now all functions that want to call <code>serialize</code> for an object may as well be oblivious to what the <em>actual</em> serializer within the entity. Keep in mind that this is nearly impossible to achieve with plain multiple inheritance as users would have to handle the combinatorial explosion of different <code>serializer</code>'s, <code>data</code>'s and other possible super-classes.</p>
<p>The above example shows that an ECS is, in most cases, a better choice than multiple inheritance. But what about composition?</p>
<p>Well, an ECS is a type of composition, with one difference. An entity has no idea what kind of components may be a part of it.</p>
<p>Imagine a the straight-forward way to composition. An object from our system will have methods like <code>get_serializer()</code>, <code>get_data()</code>, and more. This means that every time we add a new sub-system, we'll have to change the object type to "enrich" it with its new components. Removing the aforementioned limitation allows independent sub-system development &ndash; without changing the code of the original product. I also allows the introduction of entire subsystems with dynamic libraries, which don't change the binary. For example, writing an entirely new serialization mechanism &ndash; say encrypted serialization &ndash; for a product and introducing it as an optional plug-in becomes a breeze.</p>
<h2><a class="anchor" id="nonpoly_ecs"></a>
Non-polymorphic entity-component-systems </h2>
<p>There exists a technique, often also called entity-component-system, that is not polymorphic. It can be combined to a degree with code like the one described above but it requires special maintenance.</p>
<p>Essentially what it does is, the entity has pointers (or sometime indexes) of concrete components, that aren't managed by it, but by the subsystems that use these components. The subsystems contain dense arrays of these components, which they process, often being oblivious of entities and other higher-level concepts.</p>
<p>This is done in very performance heavy pieces of software, where the cache locality of the data is critical. Since polymorphism is incompatible with cache locality, those systems sacrifice (at least to some degree) the ease of use and maintainability for the speed.</p>
<p>This is especially popular in high-end games, where in order to produce state of the art graphics and physics with a decent framerate, each microsecond is of importance.</p>
<h2><a class="anchor" id="who_uses_ecs"></a>
Who uses entity-component-systems? </h2>
<p>They are very popular in game development, as most objects in a game have many different aspects for different sub-systems. Still, being as powerful as they are, they find their place in many other pieces of software developed in C++, Java or C#.</p>
<p>It is the author's opinion that any big project with complex objects could benefit from using an ECS. Indeed games and game engines are a prime example of such a project, but there are many others. Any software that has optional dynamic library plug-ins, most CAD systems, graph editors, project management tools, and many others.</p>
<p>Most script-language objects natively support a functionality resembling the polymorphic form of these systems, and most of them call it <em>Mixins</em>.</p>
<h2><a class="anchor" id="more_ecs"></a>
Further reading </h2>
<ul>
<li>In his e-book Game Programming Patterns, Robert Nystrom has a wonderful <a href="http://gameprogrammingpatterns.com/component.html">chapter, called Components</a>, in which he describes the benefits of using an ECS and gives a simple example.</li>
<li>Adam Martin has a great <a href="http://t-machine.org/index.php/2007/09/03/entity-systems-are-the-future-of-mmog-development-part-1/">series of articles</a> on the subject. Especially on how such systems are related to game and MMOG development.</li>
<li>An existing simple classic entity-component-system is <a href="http://code.google.com/p/cistron/">cistron</a> by Karel Crombecq. You can also check out the <a href="http://www.codeximperium.be/stuff/Component-based%20programming.pdf">slides</a> from his presentation on the subject.</li>
<li>Building Object Systems is a talk by Alex Duran. The slides are available <a href="http://wenku.baidu.com/view/7917fe26ccbff121dd3683b6.html">here</a>.</li>
<li>Chris Granger has an <a href="http://www.chris-granger.com/2012/12/11/anatomy-of-a-knockout/">article</a> on the benefits of using an entity-component-system in ClojureScript for game development</li>
<li>An interesting discussion on the subject can be found at the <a href="http://forums.xkcd.com/viewtopic.php?f=11&amp;t=81459">xkcd forums</a>.</li>
</ul>
<h1><a class="anchor" id="app_vs_watch"></a>
Appendix B. Visual Studio watch visualizers </h1>
<p>If you're using Microsoft Visual Studio 2015, you can install a special watch visualizer which will make adding <code><a class="el" href="classdynamix_1_1object.html" title="The main object class. ">dynamix::object</a></code> in a watch window a better experience.</p>
<p>The result when adding a watch on an object should resemble this:</p>
<div class="image">
<img src="vs_natvis.png" alt="vs_natvis.png"/>
<div class="caption">
natvis file</div></div>
<p> To install this visualizer:</p>
<ul>
<li>Locate <code>dynamix.natvis</code> in your DynaMix installation. It should be in the <code>tools</code> subdirectory.</li>
<li>To install for your user only, copy it to <code>&lt;Documents&gt;\&lt;Visual Studio Version&gt;\Visualizers</code>. If the directory doesn't exist, create it manually.</li>
<li>To install for all users, copy it to <code>VSINSTALLDIR%\Common7\Packages\Debugger\Visualizers</code>. You will need administrator access to do this.</li>
</ul>
<h2><a class="anchor" id="watch_mixin"></a>
Watching a mixin </h2>
<p>To watch concrete mixin from an object, you should add a new watch where you explicitly cast the address to the correct mixin type. The visualizer only helps you quickly find the address and the target type. It doesn't (and unfortunately can't) perform the cast.</p>
<p>If you perform the cast correctly, the result will resemble this:</p>
<div class="image">
<img src="vs_watch.png" alt="vs_watch.png"/>
<div class="caption">
watch</div></div>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Nov 11 2018 10:50:39 for DynaMix by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
